---
layout: default
---
{% assign layout_type = 'module' %}
{% assign child_modules = site.pages | where_exp: "item", "item.url contains page.url" | where_exp: "item", "item.layout contains layout_type"%}
{% assign tags = child_modules | map: "tags" | uniq | compact %}

<div class="button-group filter-button-group">
    <h3>Filter</h3>
    <!--<button type="button" class="btn btn-primary btn-sm" data-filter="*">All</button>-->
    {% for tag in tags %}
    <button type="button" class="btn btn-secondary btn-sm" data-filter=".{{ tag | remove:' ' }}">
       {{ tag }}
    </button>
    {% endfor %}
  </div>
  <!--SORTING
  <div class="button-group sort-by-button-group">
    <h3>Sort</h3>
    <button type="button" class="btn btn-primary btn-sm" data-sort-by="original-order">Normal</button>
    <button type="button" class="btn btn-secondary btn-sm" data-sort-by="title">Name</button>
    <button type="button" class="btn btn-secondary btn-sm" data-sort-by="tag">Tag</button>
    </div>
  </div>
  -->
  <div class="module-filter">
    {% for module in child_modules %}
    <div class="module-item {% for tag in module.tags %}{{tag | remove:' '}} {% endfor%}" data-tag="{% for tag in module.tags %}{{tag | remove:' '}}{% endfor%}" data-title="{{ module.title | remove: ' '}}">
            {% include card.html title=module.title url= module.url image=module.image %}
    </div>
    {% endfor %}
  </div>




  <script type="text/javascript" src="{{ '/assets/js/vendor/isotope.min.js' | absolute_url }}"></script>
  <script>

      $(document).ready(function() {var $moduleFilter = $('.module-filter').isotope({
        itemSelector: '.module-item',
        layoutMode: 'masonry',
        masonry: {
            columnWidth: 240,
            fitWidth: true
        },
        getSortData: {
          title: '[data-title]', 
          tag: '[data-tag]',
        }
      });
      /* sorting */
      $('.sort-by-button-group').on('click', 'button', function(){
        var sortByValue = $(this).attr('data-sort-by');
        $moduleFilter.isotope({ sortBy: sortByValue });
      });
      $('.sort-by-button-group button.btn').on('click', function(){
          $('.sort-by-button-group button.btn').removeClass('btn-primary');
          $('.sort-by-button-group button.btn').addClass('btn-secondary');
          $(this).removeClass('btn-secondary');
          $(this).addClass('btn-primary');
      });
      /* filtering */

      var filters = [];
      function addFilter( filter ) {
        if ( filters.indexOf( filter ) == -1 ) {
          filters.push( filter );
        }
      }

      function removeFilter( filter ) {
        var index = filters.indexOf( filter);
        if ( index != -1 ) {
          filters.splice( index, 1 );
        }
      }
      $('.filter-button-group button.btn').on('click', function(){
        $(this).toggleClass('is-checked');
        /*$(this).button('toggle');*/
        var isChecked = $(this).hasClass('is-checked');
        var filter = $(this).attr('data-filter');
        if ( isChecked ) {
          $(this).removeClass('btn-secondary');
          $(this).addClass('btn-primary');
           addFilter( filter );
        } else {
          $(this).removeClass('btn-primary');
          $(this).addClass('btn-secondary');
          removeFilter( filter );
        }
        /*filter isotope*/
        /* group filters together, inclusive*/
        $moduleFilter.isotope({ filter: filters.join(',') });
        $moduleFilter.isotope('updateSortData').isotope();

      });
    });

      
  </script>
  <style type="text/css">
    .module-item {
        float: left;
        width: 240px;
        height: 300px;
    }

    .module-item--width2 { width: 480px; }
    .module-item--height2 { height: 480px; }
  </style>